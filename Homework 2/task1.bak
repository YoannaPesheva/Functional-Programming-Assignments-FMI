#lang racket
(require racket/trace)

#|(define (cross-water-min-risk risks)
  (define (helper stones acc)
    (cond
      ((null? stones) acc)
      ((null? (cdr stones)) (+ acc (car stones)))
      (else
       (if (< (car stones) (cadr stones))
           (helper (cddr stones) (+ acc (car stones)))
           (helper (cddr stones) (+ acc (cadr stones) (if (null? (cddr stones)) 0 (car (cddr stones)))))))))
  )

;; Example usage:
(displayln (cross-water-min-risk '(734 401 273 823 715 216 960 474 91 568)))
|#


(define (cross-water-min-risk risks)
  (define (helper copy-risks sum)
    (cond
      ((null? (cdr copy-risks)) sum)
      ((null? (cddr copy-risks)) (+ sum (min (car copy-risks) (cadr copy-risks))))
      ((<= (car copy-risks) (cadr copy-risks))
       (if (and
            (< (cadr copy-risks) (+ (car copy-risks) (caddr copy-risks)))
            (< (caddr copy-risks) (cadr copy-risks)))
           
           (helper (cddr copy-risks) (+ sum (cadr copy-risks)))
           (helper (cdr copy-risks) (+ sum (car copy-risks)))
       ))
      (else
         (helper (cddr copy-risks) (+ sum (cadr copy-risks)))
       )
    )
)
   (trace helper)
  (helper risks 0)
  )


; (cross-water-min-risk '(10 15 20)) ; → 15
; (cross-water-min-risk '(1 100 1 1 1 100 1 1 100 1)); → 6
; (cross-water-min-risk '(458 896 809 929 430 241)); → 1697
; (cross-water-min-risk '(945 726 301 716 642 149)); → 1591
; (cross-water-min-risk '(192 31 533 573 772 31)); → 635
; (cross-water-min-risk '(734 401 273 823 715 216 960 474 91 568)); → 2005
(cross-water-min-risk '(793 413 20 210 963 733 992 500 660 43)); → 1899

